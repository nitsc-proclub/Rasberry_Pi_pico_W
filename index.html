<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>とうほくプロコンワークショップ「ラズパイPicoで酷暑を乗り切ろう」</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <style>
        /* ========== 基本設定と配色 ========== */
        :root {
            /* ライトモードの配色 */
            --bg-color: #f7f9fc;
            --text-color: #2c3e50;
            --heading-color: #1c2833;
            --link-color: #007bff;
            --border-color: #e0e7ef;
            --accent-blue: #02A1FD;
            --accent-yellow: #F9D805;
            --code-bg: #fdfdfd; /* 少しだけ色味を変更 */
            --main-bg: #ffffff;
            --table-stripe-bg: #f8f9fa;
            --details-open-bg: #f0f7ff;
            --header-bg: rgba(255, 255, 255, 0.85);
            --btn-bg: #e9ecef;
            --btn-text: #495057;
        }

        /* ダークモードの配色 */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #1a1a1a;
                --text-color: #ecf0f1;
                --heading-color: #ffffff;
                --link-color: #3498db;
                --border-color: #34495e;
                --accent-blue: #3498db;
                --accent-yellow: #f1c40f;
                --code-bg: #2c2c2c;
                --main-bg: #212121;
                --table-stripe-bg: #2c3e50;
                --details-open-bg: #283747;
                --header-bg: rgba(26, 26, 26, 0.85);
                --btn-bg: #34495e;
                --btn-text: #ecf0f1;
            }
        }

        /* ========== 全体のスタイルとフォント設定 ========== */
        body {
            margin: 0;
            font-family: 'Noto Sans JP', "Hiragino Kaku Gothic ProN", "Yu Gothic UI", "Segoe UI", system-ui, -apple-system, sans-serif;
            font-size: 17px;
            line-height: 1.9;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        /* ========== ヘッダー ========== */
        header.site {
            padding: 1rem 1.5rem;
            border-bottom: 2px solid;
            border-image: linear-gradient(to right, var(--accent-blue), var(--accent-yellow)) 1;
            position: sticky;
            top: 0;
            background-color: var(--header-bg);
            backdrop-filter: blur(10px);
            z-index: 100;
            display: flex;
            align-items: center;
        }

            header.site h1 {
                margin: 0;
                font-size: 1.25rem;
                color: var(--heading-color);
            }

        /* ========== レイアウト ========== */
        .page-wrapper {
            /* コンテンツ全体の最大幅を設定します */
            max-width: 1320px;
            /* ブロック自体を左右の中央に配置します（最も確実な方法です）*/
            margin-left: auto;
            margin-right: auto;
            /* 以下はコンテナ内のレイアウト設定です */
            display: grid;
            align-items: start;
            gap: 2rem;
            padding: 0 2rem;
            width: 100%;
            box-sizing: border-box;
            /* 本文(1fr)と目次(240px)の列を定義します */
            grid-template-columns: 1fr 240px;
        }

        main {
            /* 本文は1列目に配置されます */
            grid-column: 1;
            background-color: var(--main-bg);
            padding: 1.5rem 2.5rem;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.05);
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        .toc-container {
            /* 目次は2列目に配置されます */
            grid-column: 2;
            position: sticky;
            top: 90px;
            padding-top: 2rem;
        }

        /* ========== タイポグラフィと見出し ========== */
        h1, h2, h3, h4 {
            scroll-margin-top: 90px;
            color: var(--heading-color);
            font-weight: 700;
        }

        h2 {
            font-size: 1.8rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid;
            border-image: linear-gradient(to right, var(--accent-blue), var(--accent-yellow)) 1;
            margin-top: 3rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
        }

            h2::before {
                content: '✔';
                display: inline-block;
                width: 1.8rem;
                height: 1.8rem;
                line-height: 1.8rem;
                text-align: center;
                background: linear-gradient(135deg, var(--accent-blue), var(--accent-yellow));
                color: white;
                font-size: 1.2rem;
                margin-right: 0.8rem;
                border-radius: 50%;
            }

        h3 {
            font-size: 1.5rem;
            border-bottom: 2px dashed var(--accent-blue);
            padding-bottom: 0.3rem;
        }

        h4 {
            font-size: 1.2rem;
            border-left: 5px solid var(--accent-yellow);
            padding-left: 0.8rem;
            background-color: var(--table-stripe-bg);
            padding-top: 0.2rem;
            padding-bottom: 0.2rem;
        }

        /* ========== コードブロックとコピーボタン ========== */
        pre, code, kbd, samp {
            font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', "SFMono-Regular", Menlo, Consolas, "Liberation Mono", monospace;
            font-size: .95rem;
            line-height: 1.75;
        }

        pre {
            position: relative; /* コピーボタンを配置するため */
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            border-left: 5px solid var(--accent-blue);
            border-radius: .5rem;
            padding: 1rem;
            overflow: auto;
        }

        code {
            background: var(--table-stripe-bg);
            padding: .1rem .4rem;
            border-radius: .3rem;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        pre code {
            background: transparent;
            padding: 0;
            border: none;
        }

        /* ★コピーボタンのスタイル */
        .copy-btn {
            position: absolute;
            top: 0.6rem;
            right: 0.6rem;
            background-color: var(--btn-bg);
            color: var(--btn-text);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 0.25rem 0.6rem;
            font-size: 0.8rem;
            font-family: 'Noto Sans JP', sans-serif;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.2s ease;
        }

        pre:hover .copy-btn {
            opacity: 1;
        }

        .copy-btn:hover {
            background-color: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .copy-btn.copied {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }


        /* ========== レスポンシブ調整 ========== */
        @media (max-width: 1200px) {
            .page-wrapper {
                grid-template-columns: 1fr;
                padding: 0 1rem;
                gap: 0;
            }

            main {
                grid-column: 1;
                padding: 1rem 1.5rem;
            }

            .toc-container {
                display: none;
            }
        }

        /* (省略) 他のスタイルは変更なし */
        footer.site-footer {
            padding: 2rem 1rem;
            text-align: center;
            color: #888;
            margin-top: 2rem;
            border-top: 2px solid;
            border-image: linear-gradient(to right, var(--accent-blue), var(--accent-yellow)) 1;
        }

        .toc-container h3 {
            margin-top: 0;
            font-size: 1rem;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 0.5rem;
            color: var(--heading-color);
        }

        .toc-container ul {
            list-style: none;
            padding-left: 0;
        }

        .toc-container li a {
            display: block;
            padding: 0.3rem 0.5rem;
            color: var(--text-color);
            text-decoration: none;
            border-radius: 0.3rem;
            transition: all 0.2s;
            border-left: 4px solid transparent;
        }

            .toc-container li a:hover {
                background-color: var(--details-open-bg);
                border-left-color: var(--accent-yellow);
                transform: translateX(4px);
            }

        .toc-container .toc-h3 {
            padding-left: 1.2rem;
            font-size: 0.9em;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5rem auto;
            border-radius: 8px;
            border: 2px solid var(--border-color);
        }

        a {
            color: var(--link-color);
            text-decoration: none;
            font-weight: 600;
        }

            a:hover {
                color: var(--accent-blue);
                text-decoration: underline;
                text-decoration-color: var(--accent-yellow);
                text-decoration-thickness: 2px;
            }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1.5rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: .8rem 1rem;
            text-align: left;
        }

        th {
            background-color: var(--accent-blue);
            color: white;
        }

        tbody tr:nth-of-type(odd) {
            background-color: var(--table-stripe-bg);
        }

        details {
            border: 1px solid var(--accent-blue);
            border-radius: .5rem;
            margin: 1rem 0;
            background: var(--details-open-bg);
        }

            details > summary {
                padding: .8rem 1.2rem;
                font-weight: 600;
                cursor: pointer;
                user-select: none;
                transition: background-color 0.2s;
                background-color: #fff;
                border-radius: .4rem;
                background: linear-gradient(to right, #e3f2fd, #fff);
            }

            details[open] > summary {
                border-bottom: 1px dashed var(--border-color);
            }

            details > *:not(summary) {
                padding: 1rem 1.2rem;
            }
    </style>
</head>
<body>
    <header class="site">
        <h1>とうほくプロコンワークショップ「ラズパイPicoで酷暑を乗り切ろう」</h1>
    </header>

    <div class="page-wrapper">
        <main id="content"><article class="doc" id="md-root">読み込み中…</article></main>
        <aside class="toc-container" id="toc-container">
            <h3>目次</h3>
            <nav id="toc-nav"></nav>
        </aside>
    </div>

    <footer class="site-footer">
        <p>制作：2025 仙台高専プログラミング部</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highlight.js/lib/common/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/github-dark.min.css" media="(prefers-color-scheme: dark)">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/github.min.css" media="(prefers-color-scheme: light)">

    <script id="md-payload" type="application/json">
        "# とうほくプロコンワークショップ「ラズパイPicoで酷暑を乗り切ろう」\n\n## 準備\n - Raspberry Pi pico W（ラズベリー パイ ピコ ダブリュー）\n - USBケーブル（USBマイクロB端子⇔USB-A端子）\n - パソコン（Thonyインストール済）\n1. パソコンでThonyを起動\n2. パソコンとラズパイをUSBケーブルで接続\n<img src=\"https://github.com/nitsc-proclub/Rasberry_Pi_pico_W/blob/main/images/cable_connect.png\" width=\"80%\" />\n3. Thonyでラズパイを使用する設定を行う\n<img src=\"https://github.com/nitsc-proclub/Rasberry_Pi_pico_W/blob/main/images/thony_setting.png\" width=\"80%\" />\n\n## プログラムを書こう \n### print文\nThonyでコードを打ち込んで「実行ボタン▶️」を押しましょう。\n```python\nprint(\"Hello, World!\")\n```\n▶️実行結果  \n<img src=\"https://github.com/nitsc-proclub/Rasberry_Pi_pico_W/blob/main/images/result1.png\" width=\"80%\" />\n- **`print`は文や数を表示する指示です。**\n\t - 文字を表示するときは `\"こんにちは\"` このように囲います。\n     - `print(1+1)` のように書くと、算数の計算もできます。\n     - 2つ以上のプログラムを書きたいときは、以下のように改行しましょう。\n```python\nprint(1)\nprint(2)\n```\n\n#### 算数の計算\n💡`print`に計算の式を入れて遊んでみましょう\n\n| 計算 | 記号 |\n| ------------- | ------------- |\n| たしざん | + |\n| ひきざん | - |\n| かけざん | * |\n| わりざん | / |\n\n\n#### 例➀\n```python\nprint(6 / 3)\n```\n<details>\n<summary>例➀の実行結果</summary>\n\n```python\n2\n```\n6わる3は2です。\n</details><br>\n\n#### 例➁\n```python\nprint(2 * 4)\n```\n<details>\n<summary>例➁の実行結果</summary>\n\n```python\n8\n```\n2かける4は8です。\n</details><br>\n\n#### 例➂\n```python\nprint(5 + 4)\n```\n<details>\n<summary>例➂の実行結果</summary>\n\n```python\n9\n```\n5たす4は9です。\n</details><br>\n\n## 回路をつくる準備\n#### ブレッドボード\n - 部品を差し込む穴がたくさんある板  \n - 簡単に回路をつくれます\n<img src=\"https://github.com/nitsc-proclub/Rasberry_Pi_pico_W/blob/main/images/breadboard.png\" width=\"30%\" />\n ボードの内部で線がつながっています \n<img src=\"https://github.com/nitsc-proclub/Rasberry_Pi_pico_W/blob/main/images/breadboard_line.png\" width=\"70%\" />\n\n#### ラズパイをボードに差し込む\n画像のように差し込みましょう  \n\n<img src=\"https://github.com/nitsc-proclub/Rasberry_Pi_pico_W/blob/main/images/breadboard_rasberrypi.png\" width=\"50%\" />\n\n## LEDを光らせる\n#### LEDとは\n - 発光ダイオード\n - 電気を流すと光ります\n - 足が2本です\n   - 足が長い方が＋（プラス）\n   - 足が短い方－（マイナス）\n   \n購入はこちら：https://akizukidenshi.com/catalog/g/g111577/\n\n### LEDの接続\n - ラズパイの左上から7番目のピンの横に足が長い方を差し込みます\n - ラズパイの左上から8番目に短い方を差し込みます\n<img src=\"https://github.com/nitsc-proclub/Rasberry_Pi_pico_W/blob/main/images/LED_connect.png\" width=\"80%\" />\n\n### LEDのプログラム\n```python\nfrom picozero import LED        # LED制御用\nfrom time import sleep          # 待ち時間\n\nled1 = LED(5)                   # GP5にLED接続\n\nwhile True:                     # ずっと繰り返す\n    led1.on()                   # 点灯\n    sleep(0.5)                  # 0.5秒待つ\n    led1.off()                  # 消灯\n    sleep(0.5)                  # 0.5秒待つ\n```\nプログラムを日本語に直すと以下のようになります。\n```\nLEDを制御する宣言\n待ち時間を指定する宣言\n\nGPIO5番ピン(GP05)を使用することをラズパイに伝える\n\nここから下が無限ループ\n    LEDを点灯させる\n    0.5秒待つ\n    LEDを消灯させる\n    0.5秒待つ\n```\n#### 動作\n0.5秒ごとに点灯⇔消灯をくりかえします\n\n<img src=\"https://github.com/nitsc-proclub/Rasberry_Pi_pico_W/blob/main/videos/LED.gif\" width=\"30%\" />\n\n___\n> ⚠️\n> **これ以降の内容は未完成です🙇今後更新していきます。**\n___\n\n## 温度センサで温度を測る\n### 温度センサの接続\n### 温度センサのプログラム\n```python\nfrom picozero import TemperatureSensor  # ADCを電圧[V]に変換\nfrom time import sleep\t\t\t# 待ち時間\n\nts = TemperatureSensor(28)              # GP28（ADC2）に温度センサを接続\n\nwhile True: \t\t\t\t# ずっと繰り返す\n    v = ts.voltage                      # 電圧を取得\n    temp = (v - 0.400) / 0.0195         # 電圧を温度に変換する式\n    print(f\"{temp:.3f}°C\")\t\t# 温度を表示\n    sleep(0.2)                          # 0.2秒待つ\n```\n\n## サーボモーターを動かす\n### サーボモーターの接続\n### サーボモーターのプログラム\n```python\nfrom picozero import Servo   # サーボ用\nfrom time import sleep       # 待ち時間\n\nservo = Servo(0, None, 0.0005, 0.0024) # GP0に接続して初期化\n\nwhile True:                  # ずっと繰り返す\n    servo.value = 45 / 180   # サーボを45°に動かす\n    sleep(0.5)               # 0.5秒待つ\n    servo.value = 135 / 180  # サーボを135°に動かす\n    sleep(0.5)               # 0.5秒待つ\n```\n\n## 作品制作：暑いときに自動であおぐうちわ\n### サーボモーターと温度センサの接続\n### 暑いときに自動であおぐうちわのプログラム\n```python\nfrom picozero import TemperatureSensor, Servo    # 温度センサとサーボを使用\nfrom time import sleep                           # 待ち時間\n\nTH = 28.0                                        # しきい値(温度)：これを超えたら作動\n\nservo = Servo(0, None, 0.0005, 0.0024)\t       # サーボ(GP0)\nts = TemperatureSensor(28)                       # 温度センサ(GP28/ADC2)\n\nwhile True:                                      # 無限ループ\n    temp = (ts.voltage - 0.400) / 0.0195         # 電圧→温度[℃]に変換（MCP9701）\n    print(f\"{temp:.1f}℃\")                       # 温度を表示\n    if temp > TH:                                # しきい値を超えた？\n        servo.value = 45/180                     # 45度に動かす\n        sleep(0.5)                               # 0.5秒待つ\n        servo.value = 135/180                    # 135度に動かす\n        sleep(0.5)                               # 0.5秒待つ\n```\n\n## 照度センサで明るさを測る\n### 照度センサの接続\n### 照度センサのプログラム\n```python\nfrom picozero import Button         # 照度センサ→Button扱い\nfrom time import sleep              # 待ち時間\n\n# GP15に照度センサの片足を接続（もう片足はGND）\nlight = Button(15, pull_up=True)\n\nWhile True:                         # ずっと繰り返す\n    if light.is_pressed: print(\"明るい\") # もし 明るかったら「明るい」と表示\n    else: print(“暗い”)        　# そうでなければ（暗かったら）「暗い」と表示\n    sleep(0.1)                      # 0.1秒待つ\n```\n"
    </script>

    <script>
        // GitHubの画像URLを直接表示可能なURLに変換
        function toRawGitHub(url) {
            try {
                const u = new URL(url);
                if (u.hostname === 'github.com' && !url.includes('raw.githubusercontent.com')) {
                    if (url.endsWith('.gif')) {
                        u.searchParams.set('raw', 'true');
                        return u.toString();
                    }
                    const parts = u.pathname.split('/').filter(Boolean);
                    const blobIdx = parts.indexOf('blob');
                    if (blobIdx >= 2) {
                        const org = parts[0], repo = parts[1], branch = parts[blobIdx + 1];
                        const path = parts.slice(blobIdx + 2).join('/');
                        return `https://raw.githubusercontent.com/${org}/${repo}/${branch}/${path}`;
                    }
                }
                return url;
            } catch (e) { return url; }
        }

        // `summary`タグの不要なネストを整形
        function normalizeSummary(container) {
            const summaries = Array.from(container.querySelectorAll('summary'));
            summaries.forEach(sm => {
                if (sm.parentElement && sm.parentElement.tagName === 'DETAILS') return;
                const h = document.createElement('h4');
                h.textContent = sm.textContent || '項目';
                sm.replaceWith(h);
            });
        }

        // 目次（TOC）を自動生成
        function generateTOC() {
            const contentRoot = document.getElementById('md-root');
            const tocNav = document.getElementById('toc-nav');
            if (!contentRoot || !tocNav) return;

            const headings = contentRoot.querySelectorAll('h2, h3');
            if (headings.length === 0) {
                document.querySelector('.toc-container').style.display = 'none';
                return;
            }

            const tocList = document.createElement('ul');

            headings.forEach((heading, index) => {
                const id = heading.id || `heading-${index}`;
                if (!heading.id) { heading.id = id; }
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.href = `#${id}`;
                link.textContent = heading.textContent;
                if (heading.tagName === 'H3') { listItem.classList.add('toc-h3'); }
                listItem.appendChild(link);
                tocList.appendChild(listItem);
            });
            tocNav.appendChild(tocList);
        }

        // ★コピーボタンを追加する関数
        function addCopyButtons() {
            const codeBlocks = document.querySelectorAll('pre');
            codeBlocks.forEach(block => {
                const code = block.querySelector('code');
                if (!code) return; // codeタグがない場合は何もしない

                const btn = document.createElement('button');
                btn.className = 'copy-btn';
                btn.textContent = 'コピー';

                btn.addEventListener('click', () => {
                    navigator.clipboard.writeText(code.innerText).then(() => {
                        btn.textContent = 'コピーしました！';
                        btn.classList.add('copied');
                        setTimeout(() => {
                            btn.textContent = 'コピー';
                            btn.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        btn.textContent = '失敗';
                        console.error('Copy failed', err);
                    });
                });
                block.appendChild(btn);
            });
        }

        // メインの処理
        (function () {
            const md = JSON.parse(document.getElementById('md-payload').textContent);
            if (window.marked) {
                marked.setOptions({ mangle: false, headerIds: false });
                const html = marked.parse(md);
                const root = document.getElementById('md-root');
                root.innerHTML = html;
                root.querySelectorAll('img').forEach(img => {
                    const raw = toRawGitHub(img.src);
                    if (raw !== img.src) img.src = raw;
                });
                normalizeSummary(root);
                // シンタックスハイライトを実行
                if (window.hljs && typeof hljs.highlightAll === 'function') {
                    hljs.highlightAll();
                }
                generateTOC();
                addCopyButtons(); // ★コピーボタンを追加
            } else {
                document.getElementById('md-root').textContent = md;
            }
        })();
    </script>
</body>
</html>
